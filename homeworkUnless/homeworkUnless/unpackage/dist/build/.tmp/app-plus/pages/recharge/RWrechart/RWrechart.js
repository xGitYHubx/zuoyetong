(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/recharge/RWrechart/RWrechart"],{"398f":function(e,t,a){"use strict";(function(e,r){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=o(a("a34a")),c=o(a("bfcb"));function o(e){return e&&e.__esModule?e:{default:e}}function s(e,t,a,r,n,c,o){try{var s=e[c](o),i=s.value}catch(u){return void a(u)}s.done?t(i):Promise.resolve(i).then(r,n)}function i(e){return function(){var t=this,a=arguments;return new Promise(function(r,n){var c=e.apply(t,a);function o(e){s(c,r,n,o,i,"next",e)}function i(e){s(c,r,n,o,i,"throw",e)}o(void 0)})}}var u={data:function(){return{title:"request-payment",loading:!1,price:1,providerList:[]}},onLoad:function(){var t=this;e.getProvider({service:"payment",success:function(e){console.log(r("payment success:"+JSON.stringify(e)," at pages\\recharge\\RWrechart\\RWrechart.vue:47"));var a=[];e.provider.map(function(e){switch(e){case"alipay":a.push({name:"支付宝",id:e,loading:!1});break;case"wxpay":a.push({name:"微信",id:e,loading:!1});break;default:break}}),t.providerList=a},fail:function(e){console.log(r("获取支付通道失败：",e," at pages\\recharge\\RWrechart\\RWrechart.vue:72"))}})},methods:{weixinPay:function(){var t=this;console.log(r("发起支付"," at pages\\recharge\\RWrechart\\RWrechart.vue:79")),this.loading=!0,e.login({success:function(a){console.log(r("login success",a," at pages\\recharge\\RWrechart\\RWrechart.vue:83")),e.request({url:"https://unidemo.dcloud.net.cn/payment/wx/mp?code=".concat(a.code,"&amount=").concat(t.price),success:function(a){if(console.log(r("pay request success",a," at pages\\recharge\\RWrechart\\RWrechart.vue:87")),200===a.statusCode)if(0===a.data.ret){console.log(r("得到接口prepay_id",a.data.payment," at pages\\recharge\\RWrechart\\RWrechart.vue:96"));var n=a.data.payment;e.requestPayment({timeStamp:n.timeStamp,nonceStr:n.nonceStr,package:n.package,signType:"MD5",paySign:n.paySign,success:function(t){e.showToast({title:"感谢您的赞助!"})},fail:function(t){e.showModal({content:"支付失败,原因为: "+t.errMsg,showCancel:!1})},complete:function(){t.loading=!1}})}else e.showModal({content:a.data.desc,showCancel:!1});else e.showModal({content:"支付失败，请重试！",showCancel:!1})},fail:function(a){console.log(r("fail",a," at pages\\recharge\\RWrechart\\RWrechart.vue:128")),t.loading=!1,e.showModal({content:"支付失败,原因为: "+a.errMsg,showCancel:!1})}})},fail:function(a){console.log(r("fail",a," at pages\\recharge\\RWrechart\\RWrechart.vue:138")),t.loading=!1,e.showModal({content:"支付失败,原因为: "+a.errMsg,showCancel:!1})}})},requestPaymentTest:function(t){e.request({url:this.$host+"/user/recharge",header:{Authorization:e.getStorageSync("token")},method:"post",data:{account:e.getStorageSync("account"),coin:this.price},success:function(t){1==t.data.success&&(e.showToast({title:"充值成功",icon:"success"}),c.default.getBalance(),setTimeout(function(){e.navigateBack({delta:1})},1e3)),console.log(r(t," at pages\\recharge\\RWrechart\\RWrechart.vue:171"))},fail:function(e){console.log(r(e," at pages\\recharge\\RWrechart\\RWrechart.vue:174"))}})},requestPayment:function(){var t=i(n.default.mark(function t(a,c){var o,s=this;return n.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this.providerList[c].loading=!0,t.next=3,this.getOrderInfo(a.id);case 3:if(o=t.sent,console.log(r(o.data," at pages\\recharge\\RWrechart\\RWrechart.vue:182")),console.log(r("得到订单信息",o," at pages\\recharge\\RWrechart\\RWrechart.vue:183")),200===o.statusCode){t.next=10;break}return console.log(r("获得订单信息失败",o," at pages\\recharge\\RWrechart\\RWrechart.vue:185")),e.showModal({content:"获得订单信息失败",showCancel:!1}),t.abrupt("return");case 10:e.requestPayment({provider:a.id,orderInfo:o.data,success:function(t){console.log(r("success",t," at pages\\recharge\\RWrechart\\RWrechart.vue:196")),e.showToast({title:"感谢您的赞助!"})},fail:function(t){console.log(r("fail",t," at pages\\recharge\\RWrechart\\RWrechart.vue:202")),e.showModal({content:"支付失败,原因为: "+t.errMsg,showCancel:!1})},complete:function(){s.providerList[c].loading=!1}});case 11:case"end":return t.stop()}},t,this)}));function a(e,a){return t.apply(this,arguments)}return a}(),getOrderInfo:function(t){var a="";a=plus.runtime.appid;var r="https://demo.dcloud.net.cn/payment/?payid="+t+"&appid="+a+"&total="+this.price;return new Promise(function(t){e.request({url:r,success:function(e){t(e)},fail:function(e){t(e)}})})},priceChange:function(e){console.log(r(e.detail.value," at pages\\recharge\\RWrechart\\RWrechart.vue:232")),this.price=e.detail.value}}};t.default=u}).call(this,a("6e42")["default"],a("0de9")["default"])},"5a73":function(e,t,a){"use strict";a.r(t);var r=a("398f"),n=a.n(r);for(var c in r)"default"!==c&&function(e){a.d(t,e,function(){return r[e]})}(c);t["default"]=n.a},6882:function(e,t,a){},"6c80":function(e,t,a){"use strict";var r=a("6882"),n=a.n(r);n.a},"83c6":function(e,t,a){"use strict";var r=function(){var e=this,t=e.$createElement;e._self._c},n=[];a.d(t,"a",function(){return r}),a.d(t,"b",function(){return n})},"975e":function(e,t,a){"use strict";a.r(t);var r=a("83c6"),n=a("5a73");for(var c in n)"default"!==c&&function(e){a.d(t,e,function(){return n[e]})}(c);a("6c80");var o=a("2877"),s=Object(o["a"])(n["default"],r["a"],r["b"],!1,null,null,null);t["default"]=s.exports},c7ad:function(e,t,a){"use strict";(function(e){a("af20"),a("921b");r(a("66fd"));var t=r(a("975e"));function r(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,a("6e42")["createPage"])}},[["c7ad","common/runtime","common/vendor"]]]);